@using selfies.Models

@if (User.Identity.IsAuthenticated)
{

    <text>
        <p>
            threads
        </p>
        <ul>
            @if (ViewBag.threads.Count == 0)
            {
                <text><li>no threads yet, <a href="@Url.Content("~/send")">send one</a></li></text>
            }
            else                
            {
                foreach (thread thready in ViewBag.threads)
                {
                    <text><li id="li-@thready.groupKey"><a href="@Url.Content("threads/" + thready.groupKey.Substring(0, 8))">@thready.startDate - from @thready.fromHandle.name to @thready.toHandle.name</a> <a id="@thready.groupKey" class="remover" href="#">Remove</a></li></text>
                }
            }
        </ul>
    </text>
            
} else {
 
    <text>

    <div id="welcome">

        <p>hey. authie is an easy way to send disappearing snaps and messages with your friends.</p>

        <ul>
            <li>no email required (or FB)</li>
            <li>iOS only</li>
        </ul>

        <p>just <a href="#">download</a> us on the appstore...</p>


    </div>

    </text>   
}

@section Scripts {
<script type="text/javascript">
    $(document).ready(function () {
        $("a.remover").click(function () {
            var currentId = $(this).attr('id');
            $("#li-" + currentId).fadeOut();

            $.ajax({
                url: "@Url.Content("~/api/thread")",
                data: { '': currentId },
                type: 'DELETE',
                success: function (result) {
                    // Do something with the result
                }
            });

        });
    });
</script>
}